{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from \"react-redux\";\nimport styled from 'styled-components';\nimport { Creators } from '../../ducks/machines';\nimport { Column, Row, Select, Title } from '../../static/styled-components/base';\nexport default function Filters(_ref) {\n  var type = _ref.type;\n\n  var _useSelector = useSelector(function (state) {\n    return state.Machine;\n  }),\n      machinesForFilters = _useSelector.machinesForFilters,\n      filtersChoosed = _useSelector.filters,\n      machines = _useSelector.machines;\n\n  var dispatch = useDispatch();\n\n  var _useState = useState({}),\n      filters = _useState[0],\n      setFilters = _useState[1];\n\n  var _useState2 = useState({}),\n      filtersSelecteds = _useState2[0],\n      setFiltersSelecteds = _useState2[1];\n\n  var _useState3 = useState([]),\n      filtersElement = _useState3[0],\n      setFiltersElement = _useState3[1];\n\n  function configFilters() {\n    var _filters = {};\n    var _filtersSelected = {};\n\n    if (machines.length > 1) {\n      machines.forEach(function (machine, a) {\n        var specKeys = machine.specifications ? Object.keys(machine.specifications) : [];\n        specKeys.forEach(function (k, i) {\n          _filtersSelected = _objectSpread({}, _filtersSelected, _defineProperty({}, k, null));\n\n          if (machine.specifications[k]) {\n            _filters = _objectSpread({}, _filters, _defineProperty({}, k, _filters[k] ? _filters[k].includes(machine.specifications[k]) ? _filters[k] : [].concat(_toConsumableArray(_filters[k]), [machine.specifications[k]]) : [machine.specifications[k]]));\n          }\n        });\n      });\n      setFiltersSelecteds(_filtersSelected);\n      dispatch(Creators.loadFilters(_filtersSelected));\n      setFilters(_filters);\n    }\n  }\n\n  useEffect(function () {\n    if (type == \"categories\" || type == \"manufacturer\") configFilters();\n  }, []);\n  useEffect(function () {\n    if (type == \"categories\") {\n      var _filters = {};\n\n      if (machines.length >= 1) {\n        machines.forEach(function (machine, a) {\n          var specKeys = machine.specifications ? Object.keys(machine.specifications) : [];\n          specKeys.forEach(function (k, i) {\n            if (machine.specifications[k]) {\n              _filters = _objectSpread({}, _filters, _defineProperty({}, k, _filters[k] ? _filters[k].includes(machine.specifications[k]) ? _filters[k] : [].concat(_toConsumableArray(_filters[k]), [machine.specifications[k]]) : [machine.specifications[k]]));\n            }\n          });\n        });\n        setFilters(_filters);\n      }\n    }\n  }, [machines]);\n\n  function handleChange(e) {\n    if (e.target.value == 0) {\n      dispatch(Creators.loadFilters(_objectSpread({}, filtersSelecteds, _defineProperty({}, e.target.name, null))));\n      setFiltersSelecteds(_objectSpread({}, filtersSelecteds, _defineProperty({}, e.target.name, null)));\n      return;\n    }\n\n    if (e.target.value != 0) {\n      dispatch(Creators.loadFilters(_objectSpread({}, filtersSelecteds, _defineProperty({}, e.target.name, e.target.value))));\n      setFiltersSelecteds(_objectSpread({}, filtersSelecteds, _defineProperty({}, e.target.name, e.target.value)));\n    }\n  } // function filterMachines () {\n  // \tconst keys = Object.keys(filtersSelecteds)\n  // \tlet filtersAreEmpty = true\n  // \tkeys.forEach(k => {\n  // \t\tif (filtersSelecteds[k]) filtersAreEmpty = false \n  // \t})\n  // \tif (!filtersAreEmpty) {\n  // \t\tconst machinesFiltereds = machinesForFilters.filter((m, i) => {\n  // \t\t\tlet r = false\n  // \t\t\tkeys.forEach(k => {\n  // \t\t\t\tif (m.specifications[k]){\n  // \t\t\t\t\tif (m.specifications[k] == filtersSelecteds[k])\n  // \t\t\t\t\t\tr = true\n  // \t\t\t\t}\n  // \t\t\t})\n  // \t\t\treturn r\n  // \t\t})\n  // \t\tdispatch(Creators.loadMachines(machinesFiltereds))\n  // \t} else {\n  // \t\tdispatch(Creators.loadMachines(machinesForFilters))\n  // \t}\n  // }\n\n\n  function handleDelete(i) {\n    if (i) {\n      var keys = Object.keys(filtersSelecteds);\n      setFiltersSelecteds(_objectSpread({}, filtersSelecteds, _defineProperty({}, keys[i], null)));\n      dispatch(Creators.loadFilters(_objectSpread({}, filtersSelecteds, _defineProperty({}, keys[i], null))));\n    } else {\n      var _keys = Object.keys(filtersSelecteds);\n\n      var _filtersSelected = {};\n\n      _keys.forEach(function (k, i) {\n        _filtersSelected = _objectSpread({}, _filtersSelected, _defineProperty({}, k, null));\n      });\n\n      dispatch(Creators.loadFilters(_filtersSelected));\n      setFiltersSelecteds(_filtersSelected);\n    }\n  }\n\n  function renderSelect() {\n    var keys = Object.keys(filters);\n    var elements = [];\n    keys.sort().forEach(function (k, i) {\n      elements.push(__jsx(Select, {\n        key: i,\n        name: k,\n        onChange: handleChange,\n        value: filtersSelecteds[k] == null ? 0 : filtersSelecteds[k],\n        style: {\n          flex: 1,\n          minWidth: \"200px\",\n          marginRight: '5px',\n          color: filtersSelecteds[k] == null ? \"black\" : \"red\"\n        }\n      }, __jsx(\"option\", {\n        value: 0\n      }, k.replace(/([A-Z])/g, ' $1').trim().toLowerCase()), filters[k].map(function (f) {\n        return __jsx(\"option\", {\n          value: f\n        }, f);\n      })));\n    });\n    return elements;\n  }\n\n  function renderFilterSelecteds() {\n    var keys = Object.keys(filtersSelecteds);\n    var elements = [];\n    keys.forEach(function (k, i) {\n      return filtersSelecteds[k] ? elements.push(__jsx(Tag, {\n        onClick: function onClick() {\n          return handleDelete(i);\n        }\n      }, filtersSelecteds[k], \" \", __jsx(\"span\", {\n        style: {\n          color: \"grey\",\n          marginLeft: \"2px\"\n        }\n      }, \"X\"))) : null;\n    });\n    if (elements.length > 0) elements.push(__jsx(Tag, {\n      onClick: function onClick() {\n        return handleDelete(null);\n      }\n    }, \"LIMPAR FILTROS\"));\n    return elements;\n  }\n\n  return __jsx(Row, {\n    style: {\n      flex: 2,\n      flexWrap: \"wrap\",\n      padding: \"10px\"\n    }\n  }, renderSelect().length > 0 ? __jsx(Column, null, __jsx(Row, {\n    style: {\n      flexWrap: \"wrap\"\n    },\n    jc: \"space-between\"\n  }, \" \", renderSelect(), \" \"), __jsx(Row, null, renderFilterSelecteds())) : null);\n}\nvar Tag = styled.span.withConfig({\n  displayName: \"Filters__Tag\",\n  componentId: \"sc-1il7rhp-0\"\n})([\"border-radius:15px;background:lightgrey;padding:5px 10px;-webkit-transition:.2s;font-size:75%;margin-right:5px;color:white;cursor:pointer;transition:.2s;:hover{opacity:.8;}\"]);","map":null,"metadata":{},"sourceType":"module"}