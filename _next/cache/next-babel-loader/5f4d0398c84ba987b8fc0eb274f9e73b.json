{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useContext } from \"react\";\nimport styled from \"styled-components\";\nimport setApi from \"../../../api\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Creators as CategoriesCreators } from \"../../../ducks/categories\";\nimport { Creators as UploadCreators } from \"../../../ducks/upload\";\nimport { Creators as UtilsCreators } from \"../../../ducks/utils\";\nimport { getCategories } from \"../../../utils/categories\";\nimport { validateImage } from \"../../../utils/validate\";\nimport { Input, TextArea, Button } from \"../../../static/styled-components/base\";\nimport Message from \"../../utils/Message\";\nimport Upload from \"../../utils/Upload\";\nconst reactCtx = React.createContext({});\nexport default (() => {\n  const _this = useContext(reactCtx);\n\n  const {\n    message,\n    messageType: result,\n    messageColor: color\n  } = useSelector(state => state.Utils);\n  const {\n    name,\n    description\n  } = useSelector(state => state.Categories);\n  const {\n    file\n  } = useSelector(state => state.Upload);\n  const dispatch = useDispatch();\n  const {\n    0: visible,\n    1: setVisible\n  } = useState(false);\n\n  function createCategory() {\n    if (name) {\n      if (validateImage([\"png\"], 100, file)) {\n        const formData = new FormData();\n        formData.append(\"icon\", file);\n        setApi().post(`categories?name=${name}&description=${description}`, formData).then(response => {\n          dispatch(UtilsCreators.changeMessage(\"Categoria criada com sucesso\"));\n          dispatch(UtilsCreators.changeMessageType(true));\n          dispatch(UtilsCreators.changeMessageColor(\"green\"));\n          dispatch(CategoriesCreators.changeName(\"\"));\n          dispatch(CategoriesCreators.changeDescription(\"\"));\n          setVisible(true);\n          dispatch(UploadCreators.cleanUpUpload());\n          dispatch(UploadCreators.changeFile(null));\n          getCategories(function (err, categories) {\n            if (err) {\n              dispatch(UtilsCreators.changeMessage(err));\n              dispatch(UtilsCreators.changeMessageType(false));\n              dispatch(UtilsCreators.changeMessageColor(\"red\"));\n              setVisible(true);\n              return;\n            }\n\n            dispatch(CategoriesCreators.loadCategories(categories));\n          });\n        }).catch(err => {\n          dispatch(UtilsCreators.changeMessage(err.response ? err.response.data : err.toString()));\n          dispatch(UtilsCreators.changeMessageType(false));\n          dispatch(UtilsCreators.changeMessageColor(\"red\"));\n          setVisible(true);\n        });\n      } else {\n        dispatch(UtilsCreators.changeMessage(\"Suba imagens PNG com no máximo 100KB\"));\n        dispatch(UtilsCreators.changeMessageType(false));\n        dispatch(UtilsCreators.changeMessageColor(\"red\"));\n        setVisible(true);\n      }\n    } else {\n      dispatch(UtilsCreators.changeMessage(\"O nome é necessário\"));\n      dispatch(UtilsCreators.changeMessageType(false));\n      dispatch(UtilsCreators.changeMessageColor(\"red\"));\n      setVisible(true);\n    }\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"h3\", {\n    className: \"main-title\",\n    style: {\n      color: \"rgb(129, 22, 27)\"\n    }\n  }, \"Adicionar nova categoria\"), __jsx(\"div\", null, __jsx(Input, {\n    placeholder: \"Nome\",\n    onKeyDown: e => {\n      if (e.key == 'Enter') createCategory();\n    },\n    onChange: e => dispatch(CategoriesCreators.changeName(e.target.value)),\n    value: name\n  }), __jsx(TextArea, {\n    placeholder: \"Descri\\xE7\\xE3o\",\n    rows: \"3\",\n    onChange: e => dispatch(CategoriesCreators.changeDescription(e.target.value)),\n    value: description\n  })), visible ? __jsx(Message, {\n    result: result,\n    color: color,\n    message: message\n  }) : \"\", __jsx(Button, {\n    onClick: createCategory\n  }, \"Criar categoria\"));\n});\nconst ImageContainer = styled.div.withConfig({\n  displayName: \"addCategory__ImageContainer\",\n  componentId: \"ig1tie-0\"\n})([\"img{max-width:120px;}\"]);","map":null,"metadata":{},"sourceType":"module"}