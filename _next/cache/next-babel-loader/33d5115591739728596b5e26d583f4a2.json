{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\nimport Message from '../../utils/Message';\nimport setApi from \"../../../api\";\nimport { validateImage } from \"../../../utils/validate\";\nimport { Creators as UploadCreators } from \"../../../ducks/upload\";\nimport { Creators as ManufacturerCreators } from \"../../../ducks/manufacturer\";\nimport { Creators as UtilsCreators } from \"../../../ducks/utils\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport { Button, Input, TextArea } from \"../../../static/styled-components/base\";\nimport Upload from \"../../utils/UploadRedux\";\nimport { getManufacturers } from '../../../utils/manufacturers';\nexport default function AddManufacturer() {\n  const imageMessageError = `Extensão do arquivo enviado é inválido. Extensões permitidas ${process.env.imageExtensionPermitted.toString()}, com no máximo 10MB`;\n  const reactCtx = React.createContext({});\n\n  const _this = useContext(reactCtx);\n\n  const {\n    message,\n    messageType: result,\n    messageColor: color\n  } = useSelector(state => state.Utils);\n  const {\n    file\n  } = useSelector(state => state.Upload);\n  const dispatch = useDispatch();\n  const {\n    0: visible,\n    1: setVisible\n  } = useState(false);\n  const {\n    0: name,\n    1: setName\n  } = useState(\"\");\n  const {\n    0: description,\n    1: setDescription\n  } = useState(\"\");\n  useEffect(() => {\n    setName('');\n    setDescription('');\n    dispatch(UploadCreators.cleanUpUpload());\n  }, []);\n  const {\n    0: snackBar,\n    1: setSnackBar\n  } = useState({\n    result: \"success\",\n    open: false,\n    message: \"\"\n  });\n\n  function handleClose() {\n    setSnackBar(_objectSpread({}, snackBar, {\n      open: false\n    }));\n  }\n\n  function createManufacturer() {\n    console.log(file);\n    console.log(validateImage([\"png\", \"jpg\", \"svg\", \"JPG\", \"jpeg\", \"webp\", \"gif\", \"tiff\"], 10000, file));\n\n    if (name) {\n      if (validateImage([\"png\", \"jpg\", \"svg\", \"JPG\", \"jpeg\", \"webp\", \"gif\", \"tiff\"], 10000, file)) {\n        const formData = new FormData();\n        formData.append(\"logo\", file);\n        setApi().post(`manufacturer?name=${name}&description=${description}`, formData).then(response => {\n          setSnackBar({\n            message: \"Fabricante criada com sucesso\",\n            open: true,\n            result: \"success\"\n          });\n          setName(\"\");\n          setDescription(\"\");\n          dispatch(UploadCreators.cleanUpUpload());\n          dispatch(UploadCreators.changeFile(null));\n          getManufacturers(function (err, manufacturers) {\n            if (err) {\n              setSnackBar({\n                message: err,\n                open: true,\n                result: \"error\"\n              });\n              return;\n            }\n\n            dispatch(ManufacturerCreators.loadManufacturers(manufacturers));\n          });\n        }).catch(err => {\n          setSnackBar({\n            message: err.response ? err.response.data : err.toString(),\n            open: true,\n            result: \"error\"\n          });\n        });\n      } else {\n        setSnackBar({\n          message: \"Suba imagens PNG com no máximo 100KB\",\n          open: true,\n          result: \"error\"\n        });\n      }\n    } else {\n      setSnackBar({\n        message: \"O nome é necessário\",\n        open: true,\n        result: \"error\"\n      });\n    }\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"h3\", {\n    className: \"main-title\",\n    style: {\n      color: \"rgb(129, 22, 27)\"\n    }\n  }, \"Adicionar nova categoria\"), __jsx(\"div\", null, __jsx(Input, {\n    placeholder: \"Nome\",\n    onChange: e => setName(e.target.value),\n    value: name\n  }), __jsx(TextArea, {\n    placeholder: \"Descri\\xE7\\xE3o\",\n    rows: \"3\",\n    onChange: e => setDescription(e.target.value),\n    value: description\n  }), __jsx(ImageContainer, {\n    style: {\n      display: \"flex\",\n      justifyContent: \"center\"\n    }\n  }, __jsx(Upload, {\n    labelInputFile: \"Logo fabricante\"\n  })), __jsx(Snackbar, {\n    open: snackBar.open,\n    autoHideDuration: 3500,\n    onClose: handleClose\n  }, __jsx(Alert, {\n    severity: snackBar.result\n  }, snackBar.message))), __jsx(Button, {\n    onClick: createManufacturer\n  }, \"Criar fabricante\"));\n}\nconst ImageContainer = styled.div.withConfig({\n  displayName: \"AddManufacturer__ImageContainer\",\n  componentId: \"sc-6p5wmy-0\"\n})([\"img{max-width:220px;}\"]);","map":null,"metadata":{},"sourceType":"module"}