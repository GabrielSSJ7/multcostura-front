{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { useDispatch } from 'react-redux';\nimport setApi from '../../../api';\nimport Head from 'next/head';\nimport InputMask from \"react-input-mask\";\nimport { Input, Button, Column } from \"../../../static/styled-components/base\";\nimport { getResellers } from '../../../utils/reseller';\nimport Message from \"../../utils/Message\";\nimport { Creators as ResellerCreators } from '../../../ducks/resellers';\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"@material-ui/lab/Alert\";\nexport default (function () {\n  var _useState = useState(\"\"),\n      name = _useState[0],\n      setName = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      email = _useState2[0],\n      setEmail = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      phone = _useState3[0],\n      setPhone = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      publicPlace = _useState4[0],\n      setPublicPlace = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      district = _useState5[0],\n      setDistrict = _useState5[1];\n\n  var _useState6 = useState(\"\"),\n      city = _useState6[0],\n      setCity = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      state = _useState7[0],\n      setState = _useState7[1];\n\n  var _useState8 = useState(\"\"),\n      country = _useState8[0],\n      setCountry = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      number = _useState9[0],\n      setNumber = _useState9[1];\n\n  var _useState10 = useState(false),\n      visible = _useState10[0],\n      setVisible = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      message = _useState11[0],\n      setMessage = _useState11[1];\n\n  var _useState12 = useState(false),\n      result = _useState12[0],\n      setResult = _useState12[1];\n\n  var _useState13 = useState(\"red\"),\n      color = _useState13[0],\n      setColor = _useState13[1];\n\n  var _useState14 = useState([]),\n      listAddress = _useState14[0],\n      setListAddress = _useState14[1];\n\n  var _useState15 = useState(false),\n      listAddressVis = _useState15[0],\n      setListAddressVis = _useState15[1];\n\n  var _useState16 = useState(\"\"),\n      address = _useState16[0],\n      setAddress = _useState16[1];\n\n  var _useState17 = useState({\n    result: \"success\",\n    open: false,\n    message: \"\"\n  }),\n      snackBar = _useState17[0],\n      setSnackBar = _useState17[1];\n\n  var dispatch = useDispatch();\n  useEffect(function () {\n    function asyncFunc() {\n      var response, fAddress, sugestion, formattedAddress;\n      return _regeneratorRuntime.async(function asyncFunc$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(setApi().get(\"http://dev.virtualearth.net/REST/v1/Autosuggest?query=\".concat(address, \"&maxResults=5&key=ArBcF40dX4IT5Co3SIxT7TfvEqq3VNdafH09G2lYGLmm1PvaaFwU-xHaQLjtmpDe\")));\n\n            case 2:\n              response = _context.sent;\n              fAddress = response.data.resourceSets[0].resources[0].value;\n              sugestion = [];\n\n              for (formattedAddress in response.data.resourceSets[0].resources[0].value) {\n                sugestion.push(fAddress[formattedAddress].address.formattedAddress);\n              }\n\n              setListAddress(sugestion);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    asyncFunc();\n  }, [address]);\n\n  var focusOutEvent = function focusOutEvent(event) {\n    timeout = setTimeout(function () {\n      setListAddressVis(false);\n    }, 100);\n  };\n\n  useEffect(function () {\n    var input = document.getElementById('searchBox');\n    var timeout = null;\n    input.addEventListener('focusout', focusOutEvent);\n    return function () {\n      clearTimeout(timeout);\n      input.removeEventListener('focusout', focusOutEvent);\n    };\n  }, []);\n\n  function handleClose() {\n    setSnackBar(_objectSpread({}, snackBar, {\n      open: false\n    }));\n  }\n\n  function geoCoding(where) {\n    var response;\n    return _regeneratorRuntime.async(function geoCoding$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(setApi().get(\"http://dev.virtualearth.net/REST/v1/Locations?addressLine=\".concat(where, \"&maxResults=1&key=\").concat(process.env.mapsKey)));\n\n          case 2:\n            response = _context2.sent;\n\n            if (!(response.data.resourceSets[0].estimatedTotal != 0)) {\n              _context2.next = 7;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", response.data.resourceSets[0].resources[0].geocodePoints);\n\n          case 7:\n            setSnackBar({\n              open: true,\n              message: \"Não possível encontrar este endereço no mapa\",\n              result: 'error'\n            });\n            return _context2.abrupt(\"return\", false);\n\n          case 9:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"script\", {\n    type: \"text/javascript\",\n    src: process.env.mapsKey,\n    async: true,\n    defer: true\n  })), __jsx(Snackbar, {\n    open: snackBar.open,\n    autoHideDuration: 3500,\n    onClose: handleClose\n  }, __jsx(Alert, {\n    severity: snackBar.result\n  }, snackBar.message)), __jsx(\"h3\", {\n    className: \"main-title\",\n    style: {\n      color: \"rgb(129, 22, 27)\"\n    }\n  }, \"Adicionar novo revendedor\"), __jsx(\"div\", null, __jsx(Row, null, __jsx(Input, {\n    placeholder: \"Nome\",\n    onChange: function onChange(e) {\n      return setName(e.target.value);\n    },\n    value: name,\n    onKeyDown: Enter,\n    style: {\n      flex: 2,\n      marginRight: \"5px\"\n    }\n  }), __jsx(Input, {\n    placeholder: \"Email\",\n    onChange: function onChange(e) {\n      return setEmail(e.target.value);\n    },\n    value: email,\n    style: {\n      flex: 2,\n      marginRight: \"5px\"\n    },\n    onKeyDown: Enter\n  }), __jsx(InputMask, {\n    style: {\n      flex: 1\n    },\n    placeholder: \"Telefone\",\n    onChange: function onChange(e) {\n      return setPhone(e.target.value);\n    },\n    value: phone,\n    mask: \"+99 99 99999-9999\",\n    maskChar: \" \",\n    className: \"form-control\",\n    onKeyDown: Enter\n  })), __jsx(Column, {\n    style: {\n      position: \"relative\"\n    }\n  }, __jsx(\"div\", {\n    id: \"printoutPanel\"\n  }), __jsx(\"div\", {\n    id: \"searchBoxContainer\"\n  }, __jsx(\"input\", {\n    onFocus: function onFocus() {\n      return setListAddressVis(true);\n    },\n    className: \"form-control\",\n    type: \"text\",\n    autoComplete: \"new-password\",\n    placeholder: \"Digite o endere\\xE7o\",\n    id: \"searchBox\",\n    value: address,\n    onChange: function onChange(e) {\n      return setAddress(e.target.value);\n    }\n  })), listAddressVis ? __jsx(Column, {\n    onMouseEnter: function onMouseEnter() {\n      return setListAddressVis(true);\n    },\n    style: {\n      background: 'white',\n      boxShadow: '1px 1px 3px grey',\n      borderRadius: '5px',\n      padding: '10px',\n      position: \"absolute\",\n      top: \"50px\",\n      width: \"80%\"\n    }\n  }, listAddress.length > 0 ? listAddress.map(function (ad, i) {\n    return __jsx(Item, {\n      key: i,\n      onClick: function onClick() {\n        setAddress(ad);\n        console.log(ad);\n      },\n      style: {\n        borderBottom: \"1px solid grey\"\n      }\n    }, ad);\n  }) : __jsx(Item, null, \"Nenhuma sugest\\xE3o encontrada\")) : '')), visible ? __jsx(Message, {\n    result: result,\n    color: color,\n    message: message\n  }) : \"\", __jsx(Button, {\n    onClick: function onClick() {\n      return createReseller();\n    }\n  }, \"Criar categoria\"));\n\n  function createReseller() {\n    var geocode;\n    return _regeneratorRuntime.async(function createReseller$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(geoCoding(address));\n\n          case 2:\n            geocode = _context3.sent;\n\n            if (geocode) {\n              _context3.next = 5;\n              break;\n            }\n\n            return _context3.abrupt(\"return\");\n\n          case 5:\n            setApi().post(\"/reseller\", {\n              name: name,\n              phone: phone,\n              email: email,\n              address: address,\n              geocode: {\n                lat: geocode[0].coordinates[0],\n                lng: geocode[0].coordinates[1]\n              }\n            }).then(function (response) {\n              setResult(true);\n              setColor(\"green\");\n              setMessage(\"Revendedor criado com sucesso\");\n              setVisible(true);\n              getResellers(function (err, data) {\n                dispatch(ResellerCreators.loadResellers(data));\n              });\n              resetForm();\n            })[\"catch\"](function (err) {\n              setResult(false);\n              setMessage(err.response ? err.response.data : err.toString());\n              setVisible(true);\n            });\n\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function Enter(e) {\n    if (e.key == \"Enter\") {\n      createReseller();\n    }\n  }\n\n  function resetForm() {\n    setName(\"\");\n    setEmail(\"\");\n    setPhone(\"\");\n    setAddress(\"\");\n  }\n});\nimport styled from \"styled-components\";\nvar Item = styled.p.withConfig({\n  displayName: \"AddResellers__Item\",\n  componentId: \"sc-1jbnz8c-0\"\n})([\"font-size:1rem;cursor:pointer;transition:.4s;:hover{opacity:.9;color:#81161B;}z-index:9;margin:0;padding:12px 0;:last-child{border-bottom:none !important;}\"]);\nexport var Row = styled.div.withConfig({\n  displayName: \"AddResellers__Row\",\n  componentId: \"sc-1jbnz8c-1\"\n})([\"display:flex;width:100%;flex-direction:row;justify-content:space-between;input{margin-right:5px;}\"]);","map":{"version":3,"sources":["C:/Users/Gluz/Projects/web/multcostura/multcostura-web/src/components/admin/resellers/AddResellers.jsx"],"names":["React","useState","useEffect","useDispatch","setApi","Head","InputMask","Input","Button","Column","getResellers","Message","Creators","ResellerCreators","Snackbar","Alert","name","setName","email","setEmail","phone","setPhone","publicPlace","setPublicPlace","district","setDistrict","city","setCity","state","setState","country","setCountry","number","setNumber","visible","setVisible","message","setMessage","result","setResult","color","setColor","listAddress","setListAddress","listAddressVis","setListAddressVis","address","setAddress","open","snackBar","setSnackBar","dispatch","asyncFunc","get","response","fAddress","data","resourceSets","resources","value","sugestion","formattedAddress","push","focusOutEvent","event","timeout","setTimeout","input","document","getElementById","addEventListener","clearTimeout","removeEventListener","handleClose","geoCoding","where","process","env","mapsKey","estimatedTotal","geocodePoints","e","target","Enter","flex","marginRight","position","background","boxShadow","borderRadius","padding","top","width","length","map","ad","i","console","log","borderBottom","createReseller","geocode","post","lat","coordinates","lng","then","err","loadResellers","resetForm","toString","key","styled","Item","p","Row","div"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useDispatch } from 'react-redux'\nimport setApi from '../../../api'\nimport Head from 'next/head'\nimport InputMask from \"react-input-mask\";\nimport { Input, Button, Column } from \"../../../static/styled-components/base\";\nimport { getResellers } from '../../../utils/reseller'\nimport Message from \"../../utils/Message\";\nimport { Creators as ResellerCreators } from '../../../ducks/resellers'\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"@material-ui/lab/Alert\";\n\n\nexport default  () => {\n  const [name, setName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [publicPlace, setPublicPlace] = useState(\"\");\n  const [district, setDistrict] = useState(\"\");\n  const [city, setCity] = useState(\"\");\n  const [state, setState] = useState(\"\");\n  const [country, setCountry] = useState(\"\");\n  const [number, setNumber] = useState(\"\");\n  const [visible, setVisible] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const [result, setResult] = useState(false);\n  const [color, setColor] = useState(\"red\");\n  const [listAddress, setListAddress] = useState([])\n  const [listAddressVis, setListAddressVis] = useState(false)\n  const [address, setAddress] = useState(\"\")\n  const [snackBar, setSnackBar] = useState({\n    result: \"success\",\n    open: false,\n    message: \"\"\n  });\n\n  const dispatch = useDispatch()\n\n  useEffect(() => {\n    async function asyncFunc() {\n      const response = await setApi().get(`http://dev.virtualearth.net/REST/v1/Autosuggest?query=${address}&maxResults=5&key=ArBcF40dX4IT5Co3SIxT7TfvEqq3VNdafH09G2lYGLmm1PvaaFwU-xHaQLjtmpDe`)\n      const fAddress = response.data.resourceSets[0].resources[0].value\n      const sugestion = []\n      for (let formattedAddress in response.data.resourceSets[0].resources[0].value) {\n        sugestion.push(fAddress[formattedAddress].address.formattedAddress)\n      }\n      setListAddress(sugestion)\n    }\n\n    asyncFunc();\n  }, [address])\n\n  const focusOutEvent =  (event) => {\n      timeout = setTimeout(() => {\n        setListAddressVis(false)\n      }, 100)\n    }\n\n  useEffect(() => {\n    const input = document.getElementById('searchBox')\n    let timeout = null\n    input.addEventListener('focusout', focusOutEvent);\n\n\n    return () => {\n      clearTimeout(timeout)\n      input.removeEventListener('focusout', focusOutEvent)\n    }\n  }, [])\n\n  function handleClose() {\n    setSnackBar({\n      ...snackBar,\n      open: false\n    });\n  }\n\n  async function geoCoding(where) {\n    const response = await setApi().get(`http://dev.virtualearth.net/REST/v1/Locations?addressLine=${where}&maxResults=1&key=${process.env.mapsKey}`)\n    if (response.data.resourceSets[0].estimatedTotal != 0)\n      return response.data.resourceSets[0].resources[0].geocodePoints\n    else {\n      setSnackBar({\n        open: true,\n        message: \"Não possível encontrar este endereço no mapa\",\n        result: 'error'\n      })\n      return false;\n    }\n  }\n\n  return (\n    <>\n      <Head>\n        <script type='text/javascript' src={process.env.mapsKey} async defer></script>\n      </Head>\n      <Snackbar\n          open={snackBar.open}\n          autoHideDuration={3500}\n          onClose={handleClose}\n        >\n        <Alert severity={snackBar.result}>{snackBar.message}</Alert>\n      </Snackbar>\n      <h3 className=\"main-title\" style={{ color: \"rgb(129, 22, 27)\" }}>\n        Adicionar novo revendedor\n      </h3>\n      <div>\n        <Row>\n          <Input\n            placeholder=\"Nome\"\n            onChange={e => setName(e.target.value)}\n            value={name}\n            onKeyDown={Enter}\n            style={{ flex: 2, marginRight: \"5px\" }}\n          />\n          <Input\n            placeholder=\"Email\"\n            onChange={e => setEmail(e.target.value)}\n            value={email}\n            style={{ flex: 2, marginRight: \"5px\" }}\n            onKeyDown={Enter}\n          />\n          <InputMask\n            style={{ flex: 1 }}\n            placeholder=\"Telefone\"\n            onChange={e => setPhone(e.target.value)}\n            value={phone}\n            mask=\"+99 99 99999-9999\"\n            maskChar=\" \"\n            className=\"form-control\"\n            onKeyDown={Enter}\n          />\n        </Row>\n        <Column style={{ position: \"relative\" }}>\n\n          <div id='printoutPanel'></div>\n          <div id='searchBoxContainer'>\n            <input\n              onFocus={() => setListAddressVis(true)}\n              className=\"form-control\" \n              type='text'\n              autoComplete=\"new-password\"\n              placeholder=\"Digite o endereço\" \n              id='searchBox' \n              value={address} \n              onChange={(e) => setAddress(e.target.value)}\n            />\n          </div>\n          {\n            listAddressVis ? \n            <Column onMouseEnter={() => setListAddressVis(true)} style={{ background: 'white', boxShadow: '1px 1px 3px grey', borderRadius: '5px', padding: '10px', position: \"absolute\", top: \"50px\", width: \"80%\" }}>\n              {listAddress.length > 0 ? listAddress.map((ad, i) => <Item key={i} onClick={() => {setAddress(ad);console.log(ad)}} style={{ borderBottom: \"1px solid grey\"}}>{ad}</Item> ) : <Item>Nenhuma sugestão encontrada</Item>}\n            </Column> : ''\n          }     \n        </Column>\n      </div>\n      {visible ? (\n        <Message result={result} color={color} message={message} />\n      ) : (\n        \"\"\n      )}\n      <Button onClick={() => createReseller()}>Criar categoria</Button>\n    </>\n  );\n\n  async function createReseller() {\n    const geocode = await geoCoding(address);\n    if (!geocode) return\n    setApi()\n      .post(`/reseller`, {\n        name,\n        phone,\n        email,\n        address: address,\n        geocode: {\n          lat: geocode[0].coordinates[0],\n          lng: geocode[0].coordinates[1]\n        }\n      })\n      .then(response => {\n        setResult(true);\n        setColor(\"green\");\n        setMessage(\"Revendedor criado com sucesso\");\n        setVisible(true);\n        getResellers(function (err, data ) {\n            dispatch(ResellerCreators.loadResellers(data))\n        });\n        resetForm();\n      })\n      .catch(err => {\n        setResult(false);\n        setMessage(err.response ? err.response.data : err.toString());\n        setVisible(true);\n      });\n  }\n\n  function Enter(e) {\n    if (e.key == \"Enter\") {\n        createReseller();\n    }\n  }\n\n  function resetForm() {\n    setName(\"\");\n    setEmail(\"\");\n    setPhone(\"\");\n    setAddress(\"\");\n  }\n};\n\nimport styled from \"styled-components\";\n\nconst Item = styled.p`\n  font-size: 1rem;\n  cursor: pointer;\n  transition: .4s;\n  :hover {\n    opacity: .9;\n    color: #81161B;\n  }\n  z-index: 9;\n  margin: 0;\n  padding: 12px 0;\n    :last-child {\n      border-bottom: none !important;\n  }\n`\n\nexport const Row = styled.div`\n  display: flex;\n  width: 100%;\n  flex-direction: row;\n  justify-content: space-between;\n  input {\n    margin-right: 5px;\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}