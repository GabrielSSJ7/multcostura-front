{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { Router, Link } from \"../../../routes\";\nimport setApi from \"../../../src/api\";\nimport EditGalleryImages from \"../../../src/components/admin/news/EditGalleryImages\";\nimport EditGalleryVideos from \"../../../src/components/admin/news/EditGalleryVideos\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport Template from \"../../../src/components/templates/Admin\";\nimport Sidebar from \"../../../src/components/admin/Sidebar\";\nimport { Container, Button, Input, TextArea, Hr } from \"../../../src/static/styled-components/base\";\nimport loadingGif from \"../../../src/static/images/loading.gif\";\nimport InputMask from \"react-input-mask\";\nexport default function EditNews(_ref) {\n  var id = _ref.id;\n\n  var _useState = useState({}),\n      news = _useState[0],\n      setNews = _useState[1];\n\n  var _useState2 = useState([]),\n      images = _useState2[0],\n      setImages = _useState2[1];\n\n  var _useState3 = useState([]),\n      videos = _useState3[0],\n      setVideos = _useState3[1];\n\n  var _useState4 = useState(false),\n      dis = _useState4[0],\n      setDis = _useState4[1];\n\n  var _useState5 = useState({\n    title: \"\",\n    description: \"\",\n    date: \"\"\n  }),\n      form = _useState5[0],\n      setForm = _useState5[1];\n\n  useEffect(function () {\n    function async() {\n      return _regeneratorRuntime.async(function async$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setApi().get(\"/news/\" + id).then(function (response) {\n                setNews(response.data);\n                setForm(_objectSpread({}, response.data));\n              })[\"catch\"](function (err) {\n                setSnackBar({\n                  open: true,\n                  message: err.response ? err.response.data.toString() : err.toString()\n                });\n              });\n\n              _getImages();\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    async();\n  }, []);\n  useEffect(function () {\n    if (form.description.length >= 200) {\n      setDis(true);\n      setSnackBar({\n        open: true,\n        result: \"error\",\n        message: \"A descrição deve ter no máximo 200 caractéres\"\n      });\n    } else {\n      setDis(false);\n    }\n  }, [form.description]);\n\n  function _getImages() {\n    getImages(id, function (err, r) {\n      if (err) {\n        setSnackBar({\n          result: \"error\",\n          open: true,\n          message: err.response ? err.response.data.toString() : err.toString()\n        });\n        return;\n      }\n\n      setVideos(r.gallery.videos);\n      setImages(r.gallery.images);\n    });\n  }\n\n  var _useState6 = useState(false),\n      galleryOpen = _useState6[0],\n      setGalleryOpen = _useState6[1];\n\n  var _useState7 = useState({\n    result: \"success\",\n    open: false,\n    message: \"\"\n  }),\n      snackBar = _useState7[0],\n      setSnackBar = _useState7[1];\n\n  function handleChange(e) {\n    setForm(_objectSpread({}, form, _defineProperty({}, e.target.name, e.target.value)));\n  }\n\n  function editNews() {\n    setApi().put(\"/news/\" + id, _objectSpread({}, form)).then(function (response) {\n      setSnackBar({\n        open: true,\n        result: \"success\",\n        message: \"Notícia editada com sucesso!\"\n      });\n    })[\"catch\"](function (err) {\n      setSnackBar({\n        open: true,\n        result: \"error\",\n        message: err.response ? err.response.data.toString() : err.toString()\n      });\n    });\n  }\n\n  function handleClose() {\n    setSnackBar(_objectSpread({}, snackBar, {\n      open: false\n    }));\n  }\n\n  function deleteNews() {\n    setApi()[\"delete\"](\"/news/\" + id).then(function (response) {\n      setSnackBar({\n        open: true,\n        result: \"success\",\n        message: \"Not\\xEDcia \".concat(form.title, \" exclu\\xEDda com sucesso\")\n      });\n      Router.pushRoute(\"/admin/news\");\n    })[\"catch\"](function (err) {\n      setSnackBar({\n        result: \"error\",\n        open: true,\n        message: err.response ? err.response.data.toString() : err.toString()\n      });\n    });\n  }\n\n  function removeImage(index) {\n    setApi({\n      model: \"news\",\n      type: \"images\",\n      index: index\n    })[\"delete\"](\"/gallery/\" + id).then(function (response) {\n      setSnackBar({\n        open: true,\n        result: \"success\",\n        message: \"A imagem foi excluida com sucesso!\"\n      });\n\n      _getImages();\n    })[\"catch\"](function (err) {\n      setSnackBar({\n        open: true,\n        result: \"error\",\n        message: err.response ? err.response.data.toString() : err.toString()\n      });\n    });\n  }\n\n  function removeVideo(index) {\n    setApi({\n      model: \"news\",\n      type: \"videos\",\n      index: index\n    })[\"delete\"](\"/gallery/\" + id).then(function (response) {\n      setSnackBar({\n        open: true,\n        result: \"success\",\n        message: \"O video foi excluido com sucesso!\"\n      });\n\n      _getImages();\n    })[\"catch\"](function (err) {\n      setSnackBar({\n        open: true,\n        result: \"error\",\n        message: err.response ? err.response.data.toString() : err.toString()\n      });\n    });\n  }\n\n  function onSuccess() {\n    _getImages();\n\n    setSnackBar({\n      open: true,\n      result: \"success\",\n      message: \"Os arquivos foram enviados com sucesso\"\n    });\n  }\n\n  function onError(e) {\n    setSnackBar({\n      open: true,\n      result: \"error\",\n      message: e.toString()\n    });\n  }\n\n  return __jsx(Template, null, __jsx(Snackbar, {\n    open: snackBar.open,\n    autoHideDuration: 3500,\n    onClose: handleClose\n  }, __jsx(Alert, {\n    severity: snackBar.result\n  }, snackBar.message)), __jsx(Sidebar, null), __jsx(Container, null, __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      justifyContent: \"space-around\"\n    }\n  }, __jsx(\"h1\", {\n    className: \"main-title\",\n    style: {\n      textAlign: \"center\",\n      color: \"rgb(35,43,111)\"\n    }\n  }, \"Editar \", form.title)), __jsx(Hr, null), __jsx(Form, null, __jsx(Input, {\n    placeholder: \"T\\xEDtulo\",\n    onChange: handleChange,\n    name: \"title\",\n    id: \"title\",\n    value: form.title\n  }), __jsx(TextArea, {\n    placeholder: \"Descri\\xE7\\xE3o\",\n    onChange: handleChange,\n    name: \"description\",\n    id: \"description\",\n    value: form.description,\n    rows: \"5\",\n    style: {\n      border: dis ? '2px solid red' : '',\n      outline: 'none',\n      resize: 'none'\n    }\n  }), __jsx(InputMask, {\n    placeholder: \"Data\",\n    className: \"form-control\",\n    mask: \"99/99/9999\",\n    name: \"date\",\n    maskChar: null,\n    onChange: handleChange,\n    value: form.date\n  }), __jsx(Button, {\n    style: {\n      opacity: dis ? \".8\" : \"1\"\n    },\n    onClick: editNews,\n    disabled: dis\n  }, \"Editar\"), !galleryOpen ? __jsx(Button, {\n    onClick: function onClick() {\n      return setGalleryOpen(true);\n    }\n  }, \"Atualizar Galeria de fotos e v\\xEDdeos\") : \"\", galleryOpen ? __jsx(\"div\", null, __jsx(EditGalleryImages, {\n    images: images,\n    removeImage: removeImage,\n    onSuccess: onSuccess,\n    onError: onError,\n    headers: {\n      model: \"news\",\n      type: \"images\",\n      id: id\n    }\n  }), \" \", __jsx(EditGalleryVideos, {\n    images: videos,\n    removeVideo: removeVideo,\n    onSuccess: onSuccess,\n    onError: onError,\n    headers: {\n      model: \"news\",\n      type: \"videos\",\n      id: id\n    }\n  }), \" \") : \"\", __jsx(Button, {\n    onClick: deleteNews\n  }, \"Excluir esta not\\xEDcia\"))));\n}\n\nfunction getImages(id, cb) {\n  setApi({\n    model: \"news\"\n  }).get(\"/news/\".concat(id)).then(function (response) {\n    cb(null, response.data);\n  })[\"catch\"](function (err) {\n    cb(err);\n  });\n}\n\nEditNews.getInitialProps = function (_ref2) {\n  var query = _ref2.query;\n  return {\n    id: query.id\n  };\n};\n\nvar Form = styled.div.withConfig({\n  displayName: \"edit-news__Form\",\n  componentId: \"sc-1pzc2ot-0\"\n})([\"display:flex;flex-direction:column;margin:20px;justify-content:space-between;\"]);","map":{"version":3,"sources":["C:/Users/Gluz/Projects/web/multcostura/multcostura-web/pages/admin/news/edit-news.js"],"names":["React","useState","useEffect","styled","Router","Link","setApi","EditGalleryImages","EditGalleryVideos","Snackbar","Alert","Template","Sidebar","Container","Button","Input","TextArea","Hr","loadingGif","InputMask","EditNews","id","news","setNews","images","setImages","videos","setVideos","dis","setDis","title","description","date","form","setForm","async","get","then","response","data","err","setSnackBar","open","message","toString","_getImages","length","result","getImages","r","gallery","galleryOpen","setGalleryOpen","snackBar","handleChange","e","target","name","value","editNews","put","handleClose","deleteNews","pushRoute","removeImage","index","model","type","removeVideo","onSuccess","onError","display","justifyContent","textAlign","color","border","outline","resize","opacity","cb","getInitialProps","query","Form","div"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Router, Link } from \"../../../routes\";\r\n\r\nimport setApi from \"../../../src/api\";\r\n\r\nimport EditGalleryImages from \"../../../src/components/admin/news/EditGalleryImages\";\r\nimport EditGalleryVideos from \"../../../src/components/admin/news/EditGalleryVideos\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport Template from \"../../../src/components/templates/Admin\";\r\nimport Sidebar from \"../../../src/components/admin/Sidebar\";\r\nimport {\r\n  Container,\r\n  Button,\r\n  Input,\r\n  TextArea,\r\n  Hr\r\n} from \"../../../src/static/styled-components/base\";\r\nimport loadingGif from \"../../../src/static/images/loading.gif\";\r\n\r\nimport InputMask from \"react-input-mask\";\r\n\r\nexport default function EditNews({ id }) {\r\n  const [news, setNews] = useState({});\r\n  const [images, setImages] = useState([]);\r\n  const [videos, setVideos] = useState([]);\r\n  const [dis, setDis] = useState(false)\r\n  const [form, setForm] = useState({\r\n    title: \"\",\r\n    description: \"\",\r\n    date: \"\"\r\n  });\r\n  useEffect(() => {\r\n    async function async() {\r\n      setApi()\r\n        .get(\"/news/\" + id)\r\n        .then(response => {\r\n          setNews(response.data);\r\n          setForm({ ...response.data });\r\n        })\r\n        .catch(err => {\r\n          setSnackBar({\r\n            open: true,\r\n            message: err.response\r\n              ? err.response.data.toString()\r\n              : err.toString()\r\n          });\r\n        });\r\n\r\n      _getImages();\r\n    }\r\n    async();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n      if (form.description.length >= 200) {\r\n        setDis(true);\r\n        setSnackBar({\r\n          open: true,\r\n          result: \"error\",\r\n          message: \"A descrição deve ter no máximo 200 caractéres\"\r\n        })\r\n      } else {\r\n        setDis(false)\r\n      }\r\n  }, [form.description])\r\n\r\n  function _getImages() {\r\n    getImages(id, function(err, r) {\r\n      if (err) {\r\n        setSnackBar({\r\n          result: \"error\",\r\n          open: true,\r\n          message: err.response ? err.response.data.toString() : err.toString()\r\n        });\r\n        return;\r\n      }\r\n      setVideos(r.gallery.videos);\r\n      setImages(r.gallery.images);\r\n    });\r\n  }\r\n\r\n  const [galleryOpen, setGalleryOpen] = useState(false);\r\n  const [snackBar, setSnackBar] = useState({\r\n    result: \"success\",\r\n    open: false,\r\n    message: \"\"\r\n  });\r\n\r\n  function handleChange(e) {\r\n    \r\n    setForm({\r\n      ...form,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  }\r\n\r\n  function editNews() {\r\n    setApi()\r\n      .put(\"/news/\" + id, { ...form })\r\n      .then(response => {\r\n        setSnackBar({\r\n          open: true,\r\n          result: \"success\",\r\n          message: \"Notícia editada com sucesso!\"\r\n        });\r\n      })\r\n      .catch(err => {\r\n        setSnackBar({\r\n          open: true,\r\n          result: \"error\",\r\n          message: err.response ? err.response.data.toString() : err.toString()\r\n        });\r\n      });\r\n  }\r\n\r\n  function handleClose() {\r\n    setSnackBar({\r\n      ...snackBar,\r\n      open: false\r\n    });\r\n  }\r\n\r\n  function deleteNews() {\r\n    setApi()\r\n      .delete(\"/news/\" + id)\r\n      .then(response => {\r\n        setSnackBar({\r\n          open: true,\r\n          result: \"success\",\r\n          message: `Notícia ${form.title} excluída com sucesso`\r\n        });\r\n        Router.pushRoute(\"/admin/news\");\r\n      })\r\n      .catch(err => {\r\n        setSnackBar({\r\n          result: \"error\",\r\n          open: true,\r\n          message: err.response ? err.response.data.toString() : err.toString()\r\n        });\r\n      });\r\n  }\r\n\r\n  function removeImage(index) {\r\n    setApi({ model: \"news\", type: \"images\", index })\r\n      .delete(\"/gallery/\" + id)\r\n      .then(response => {\r\n        setSnackBar({\r\n          open: true,\r\n          result: \"success\",\r\n          message: \"A imagem foi excluida com sucesso!\"\r\n        });\r\n        _getImages();\r\n      })\r\n      .catch(err => {\r\n        setSnackBar({\r\n          open: true,\r\n          result: \"error\",\r\n          message: err.response ? err.response.data.toString() : err.toString()\r\n        });\r\n      });\r\n  }\r\n  function removeVideo(index) {\r\n    setApi({ model: \"news\", type: \"videos\", index })\r\n      .delete(\"/gallery/\" + id)\r\n      .then(response => {\r\n        setSnackBar({\r\n          open: true,\r\n          result: \"success\",\r\n          message: \"O video foi excluido com sucesso!\"\r\n        });\r\n        _getImages();\r\n      })\r\n      .catch(err => {\r\n        setSnackBar({\r\n          open: true,\r\n          result: \"error\",\r\n          message: err.response ? err.response.data.toString() : err.toString()\r\n        });\r\n      });\r\n  }\r\n  function onSuccess() {\r\n    _getImages();\r\n    setSnackBar({\r\n      open: true,\r\n      result: \"success\",\r\n      message: \"Os arquivos foram enviados com sucesso\"\r\n    });\r\n  }\r\n  function onError(e) {\r\n    setSnackBar({\r\n      open: true,\r\n      result: \"error\",\r\n      message: e.toString()\r\n    });\r\n  }\r\n  return (\r\n    <Template>\r\n      <Snackbar\r\n        open={snackBar.open}\r\n        autoHideDuration={3500}\r\n        onClose={handleClose}\r\n      >\r\n        <Alert severity={snackBar.result}>{snackBar.message}</Alert>\r\n      </Snackbar>\r\n      <Sidebar />\r\n\r\n      <Container>\r\n        <div style={{ display: \"flex\", justifyContent: \"space-around\" }}>\r\n          <h1\r\n            className=\"main-title\"\r\n            style={{\r\n              textAlign: \"center\",\r\n              color: \"rgb(35,43,111)\"\r\n            }}\r\n          >\r\n            Editar {form.title}\r\n          </h1>\r\n        </div>\r\n        <Hr />\r\n        <Form>\r\n          <Input\r\n            placeholder=\"Título\"\r\n            onChange={handleChange}\r\n            name=\"title\"\r\n            id=\"title\"\r\n            value={form.title}\r\n          />\r\n          <TextArea\r\n            placeholder=\"Descrição\"\r\n            onChange={handleChange}\r\n            name=\"description\"\r\n            id=\"description\"\r\n            value={form.description}\r\n            rows=\"5\"\r\n            style={{ border: dis ? '2px solid red' : '', outline: 'none', resize: 'none'}}\r\n          />\r\n\r\n          <InputMask\r\n            placeholder=\"Data\"\r\n            className=\"form-control\"\r\n            mask=\"99/99/9999\"\r\n            name=\"date\"\r\n            maskChar={null}\r\n            onChange={handleChange}\r\n            value={form.date}\r\n          />\r\n\r\n          <Button style={{ opacity: dis ? \".8\" : \"1\"}} onClick={editNews} disabled={dis}>Editar</Button>\r\n          {!galleryOpen ? (\r\n            <Button onClick={() => setGalleryOpen(true)}>\r\n              Atualizar Galeria de fotos e vídeos\r\n            </Button>\r\n          ) : (\r\n            \"\"\r\n          )}\r\n          {galleryOpen ? (\r\n            <div>\r\n              <EditGalleryImages\r\n                images={images}\r\n                removeImage={removeImage}\r\n                onSuccess={onSuccess}\r\n                onError={onError}\r\n                headers={{ model: \"news\", type: \"images\", id }}\r\n              />{\" \"}\r\n              <EditGalleryVideos\r\n                images={videos}\r\n                removeVideo={removeVideo}\r\n                onSuccess={onSuccess}\r\n                onError={onError}\r\n                headers={{ model: \"news\", type: \"videos\", id }}\r\n              />{\" \"}\r\n            </div>\r\n          ) : (\r\n            \"\"\r\n          )}\r\n          <Button onClick={deleteNews}>Excluir esta notícia</Button>\r\n        </Form>\r\n      </Container>\r\n    </Template>\r\n  );\r\n}\r\n\r\nfunction getImages(id, cb) {\r\n  setApi({ model: \"news\" })\r\n    .get(`/news/${id}`)\r\n    .then(response => {\r\n      cb(null, response.data);\r\n    })\r\n    .catch(err => {\r\n      cb(err);\r\n    });\r\n}\r\n\r\nEditNews.getInitialProps = ({ query }) => {\r\n  return { id: query.id };\r\n};\r\n\r\nconst Form = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin: 20px;\r\n  justify-content: space-between;\r\n`;\r\n"]},"metadata":{},"sourceType":"module"}