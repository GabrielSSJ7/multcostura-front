{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport styled from \"styled-components\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport { Router } from \"../../../../routes\";\nimport { getTool, getOptions, deleteImage as _deleteImage, updateTool, deleteTool } from \"../../../utils/tools\";\nimport { getNameImageFromUrl, changeFileName, validateImage } from \"../../../utils/images\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport FileInput from \"./EditMachine/FileInput\";\nimport Message from \"../../utils/Message\";\nimport { Hr, Input, TextArea, Select, Button } from \"../../../static/styled-components/base\";\nexport default function EditMachine(_ref) {\n  var id = _ref.id;\n  var imageMessageError = \"Extens\\xE3o do arquivo enviado \\xE9 inv\\xE1lido. Extens\\xF5es permitidas \".concat(process.env.imageExtensionPermitted.toString(), \", com no m\\xE1ximo 10MB\");\n  var dispatch = useDispatch();\n\n  var _useState = useState({\n    result: \"success\",\n    open: false,\n    message: \"\"\n  }),\n      snackBar = _useState[0],\n      setSnackBar = _useState[1];\n\n  function handleClose() {\n    setSnackBar(_objectSpread({}, snackBar, {\n      open: false\n    }));\n  }\n\n  var _useState2 = useState({\n    name: \"\",\n    description: \"\",\n    mainFeatures: \"\",\n    specifications: {},\n    category: null,\n    manufacturer: null,\n    images: [],\n    productRef: []\n  }),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var _useState3 = useState({\n    toolFile1: null,\n    toolFile2: null,\n    toolFile3: null,\n    toolFile4: null,\n    toolFile5: null\n  }),\n      toolFiles = _useState3[0],\n      setToolFiles = _useState3[1];\n\n  var _useState4 = useState({\n    categories: [],\n    manufacturers: []\n  }),\n      manufacturers = _useState4[0],\n      setManufacturers = _useState4[1];\n\n  var _useState5 = useState(false),\n      visible = _useState5[0],\n      setVisible = _useState5[1];\n\n  var _useState6 = useState(false),\n      title = _useState6[0],\n      setTitle = _useState6[1];\n\n  useEffect(function () {\n    function asyncFunc() {\n      getOptions(function (err, dataCb) {\n        if (err) {\n          setSnackBar({\n            result: \"error\",\n            message: err,\n            open: true\n          });\n          return;\n        }\n\n        setManufacturers({\n          manufacturers: dataCb.manufacturers.data,\n          categories: dataCb.categories.data\n        });\n      });\n      getTool(id, function (err, tool) {\n        if (err) {\n          setSnackBar({\n            result: \"error\",\n            message: err,\n            open: true\n          });\n          return;\n        }\n\n        setState(_objectSpread({}, tool, {\n          name: tool.name,\n          description: tool.description,\n          mainFeatures: tool.mainFeatures,\n          manufacturer: tool.manufacturer\n        }));\n      });\n    }\n\n    asyncFunc();\n    return function () {};\n  }, []);\n\n  function toolHandleChange(e) {\n    if (validateImage(process.env.imageExtensionPermitted, 10000, e.target.files[0])) {\n      var newName = parseInt(e.target.name[e.target.name.length - 1]) - 1;\n      setToolFiles(_objectSpread({}, toolFiles, _defineProperty({}, e.target.name, changeFileName(e.target.files[0], newName))));\n    } else {\n      setSnackBar({\n        open: true,\n        result: 'error',\n        message: imageMessageError\n      });\n    }\n  }\n\n  function toolCleanInput(name) {\n    setToolFiles(_objectSpread({}, toolFiles, _defineProperty({}, name, null)));\n  }\n\n  function renderImage(name, type) {\n    var image = \"\";\n    state[type].forEach(function (img) {\n      var imgSplit = img.split(\"/\");\n\n      if (parseInt(name[name.length - 1]) - 1 == imgSplit[imgSplit.length - 1][0]) {\n        image = img;\n      }\n    });\n    return image;\n  }\n\n  return __jsx(React.Fragment, null, !title ? __jsx(\"h1\", {\n    className: \"main-title\",\n    style: {\n      textAlign: \"center\",\n      color: \"rgb(35,43,111)\"\n    }\n  }, state.name, __jsx(FontAwesomeIcon, {\n    icon: faPencilAlt,\n    style: {\n      width: \"16px\",\n      position: \"absolute\",\n      borderRadius: \"10px\",\n      padding: \"3px\",\n      background: \"rgb(129, 22, 27)\",\n      color: \"white\",\n      marginLeft: \"2%\",\n      top: \"20px\",\n      cursor: \"pointer\",\n      zIndex: \"9\"\n    },\n    onClick: function onClick() {\n      setTitle(true);\n    }\n  })) : __jsx(Input, {\n    style: {\n      width: \"30%\",\n      display: \"block\",\n      margin: \"15px auto\"\n    },\n    placeholder: \"Nome\",\n    value: state.name,\n    onChange: function onChange(e) {\n      return setState(_objectSpread({}, state, {\n        name: e.target.value\n      }));\n    }\n  }), __jsx(Hr, null), !title ? __jsx(\"h4\", {\n    className: \"main-title\",\n    style: {\n      textAlign: \"center\",\n      color: \"grey\"\n    }\n  }, state.description, __jsx(FontAwesomeIcon, {\n    icon: faPencilAlt,\n    style: {\n      width: \"16px\",\n      borderRadius: \"10px\",\n      padding: \"3px\",\n      background: \"rgb(129, 22, 27)\",\n      color: \"white\",\n      marginLeft: \"2%\",\n      cursor: \"pointer\",\n      zIndex: \"9\"\n    },\n    onClick: function onClick() {\n      setTitle(true);\n    }\n  })) : __jsx(Input, {\n    style: {\n      width: \"30%\",\n      display: \"block\",\n      margin: \"15px auto\"\n    },\n    placeholder: \"Subt\\xEDtulo\",\n    value: state.description,\n    onChange: function onChange(e) {\n      return setState(_objectSpread({}, state, {\n        description: e.target.value\n      }));\n    }\n  }), __jsx(\"div\", {\n    id: \"tools-images\",\n    style: {\n      width: \"100%\"\n    }\n  }, __jsx(ContainerInputFile, {\n    style: {\n      justifyContent: \"center\",\n      marginBottom: \"15px\",\n      flexWrap: \"wrap\"\n    }\n  }, __jsx(FileInput, {\n    file: toolFiles.toolFile1,\n    handleChange: toolHandleChange,\n    deleteImage: function deleteImage() {\n      return _deleteImage(state.id, \"tools\", getNameImageFromUrl(renderImage(\"toolFile1\", \"images\")), function (err) {\n        if (err) return;\n        location.reload();\n      });\n    },\n    cleanFileInput: toolCleanInput,\n    imageURL: renderImage(\"toolFile1\", \"images\"),\n    maxWidth: \"100%\",\n    labelWidth: \"70%\",\n    labelInputFile: \"Imagem principal\",\n    id: \"toolFile1\",\n    name: \"toolFile1\"\n  })), __jsx(ContainerInputFile, {\n    style: {\n      flexWrap: \"wrap\"\n    }\n  }, __jsx(FileInput, {\n    file: toolFiles.toolFile2,\n    handleChange: toolHandleChange,\n    deleteImage: function deleteImage() {\n      return _deleteImage(state.id, \"tools\", getNameImageFromUrl(renderImage(\"toolFile2\", \"images\")), function (err) {\n        if (err) return;\n        location.reload();\n      });\n    },\n    cleanFileInput: toolCleanInput,\n    imageURL: renderImage(\"toolFile2\", \"images\"),\n    labelWidth: \"200px\",\n    labelHeight: \"200px\",\n    maxWidth: \"200px\",\n    labelInputFile: \"Imagem 2\",\n    id: \"toolFile2\",\n    name: \"toolFile2\"\n  }), __jsx(FileInput, {\n    file: toolFiles.toolFile3,\n    handleChange: toolHandleChange,\n    deleteImage: function deleteImage() {\n      return _deleteImage(state.id, \"tools\", getNameImageFromUrl(renderImage(\"toolFile3\", \"images\")), function (err) {\n        if (err) return;\n        location.reload();\n      });\n    },\n    cleanFileInput: toolCleanInput,\n    imageURL: renderImage(\"toolFile3\", \"images\"),\n    labelWidth: \"200px\",\n    labelHeight: \"200px\",\n    maxWidth: \"200px\",\n    labelInputFile: \"Imagem 3\",\n    id: \"toolFile3\",\n    name: \"toolFile3\"\n  }), __jsx(FileInput, {\n    file: toolFiles.toolFile4,\n    handleChange: toolHandleChange,\n    deleteImage: function deleteImage() {\n      return _deleteImage(state.id, \"tools\", getNameImageFromUrl(renderImage(\"toolFile4\", \"images\")), function (err) {\n        if (err) return;\n        location.reload();\n      });\n    },\n    cleanFileInput: toolCleanInput,\n    imageURL: renderImage(\"toolFile4\", \"images\"),\n    labelWidth: \"200px\",\n    labelHeight: \"200px\",\n    maxWidth: \"200px\",\n    labelInputFile: \"Imagem 4\",\n    id: \"toolFile4\",\n    name: \"toolFile4\"\n  }), __jsx(FileInput, {\n    file: toolFiles.toolFile5,\n    handleChange: toolHandleChange,\n    deleteImage: function deleteImage() {\n      return _deleteImage(state.id, \"tools\", getNameImageFromUrl(renderImage(\"toolFile5\", \"images\")), function (err) {\n        if (err) return;\n        location.reload();\n      });\n    },\n    cleanFileInput: toolCleanInput,\n    imageURL: renderImage(\"toolFile5\", \"images\"),\n    labelWidth: \"200px\",\n    labelHeight: \"200px\",\n    maxWidth: \"200px\",\n    labelInputFile: \"Imagem 5\",\n    id: \"toolFile5\",\n    name: \"toolFile5\"\n  }))), __jsx(Section, null, __jsx(\"h3\", {\n    className: \"main-title\",\n    style: {\n      textAlign: \"center\",\n      color: \"rgb(129, 22, 27)\"\n    }\n  }, \"Caracter\\xEDsticas\"), __jsx(Hr, null), __jsx(\"div\", {\n    style: {\n      width: \"50%\",\n      display: \"block\",\n      margin: \"auto\"\n    }\n  }, __jsx(TextArea, {\n    value: state.mainFeatures,\n    onChange: function onChange(e) {\n      return setState(_objectSpread({}, state, {\n        mainFeatures: e.target.value\n      }));\n    },\n    rows: \"5\"\n  }, state.mainFeatures))), __jsx(Section, null, __jsx(\"h3\", {\n    className: \"main-title\",\n    style: {\n      textAlign: \"center\",\n      color: \"rgb(129, 22, 27)\"\n    }\n  }, \"Fabricante\"), __jsx(Hr, null), __jsx(\"div\", {\n    style: {\n      width: \"50%\",\n      display: \"block\",\n      margin: \"auto\"\n    }\n  }, __jsx(Select, {\n    value: state.manufacturer,\n    onChange: function onChange(e) {\n      return setState(_objectSpread({}, state, {\n        manufacturer: e.target.value\n      }));\n    }\n  }, __jsx(\"option\", {\n    value: \"\"\n  }, \"Escolha um fabricante\"), manufacturers.manufacturers.map(function (manu) {\n    return __jsx(\"option\", {\n      selected: state.manufacturer == manu.id ? manu.id : false,\n      value: manu.id\n    }, manu.name);\n  })))), __jsx(Section, null, visible ? __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      margin: \"15px auto\",\n      width: \"100%\",\n      justifyContent: \"center\"\n    }\n  }, __jsx(Message, {\n    result: result,\n    message: message,\n    color: color\n  }), \" \") : null, __jsx(Button, {\n    style: {\n      width: \"50%\",\n      margin: \"auto\",\n      display: \"block\"\n    },\n    onClick: function onClick() {\n      return updateTool(state, toolFiles, function (err, res) {\n        if (err) {\n          setSnackBar({\n            result: \"error\",\n            open: true,\n            message: err\n          });\n          return;\n        }\n\n        setSnackBar({\n          result: \"success\",\n          open: true,\n          message: \"Peça alterada com sucesso\"\n        });\n        setTimeout(function () {\n          location.reload();\n        }, 2000);\n      });\n    }\n  }, \"Salvar\"), __jsx(Button, {\n    style: {\n      width: \"50%\",\n      margin: \"15px auto\",\n      display: \"block\"\n    },\n    onClick: function onClick() {\n      return deleteTool(state.id, function (err, response) {\n        if (err) {\n          setSnackBar({\n            result: \"error\",\n            message: err,\n            open: true\n          });\n          return;\n        }\n\n        setSnackBar({\n          result: \"success\",\n          message: \"Peça excluída com sucesso\",\n          open: true\n        });\n        setTimeout(function () {\n          Router.pushRoute(\"/admin/tools\");\n        }, 2000);\n      });\n    }\n  }, \"Excluir m\\xE1quina\"), __jsx(Snackbar, {\n    open: snackBar.open,\n    autoHideDuration: 1500,\n    onClose: handleClose\n  }, __jsx(Alert, {\n    severity: snackBar.result\n  }, snackBar.message))));\n}\nexport var Section = styled.div.withConfig({\n  displayName: \"EditTool__Section\",\n  componentId: \"g78bad-0\"\n})([\"margin:10% 0;\"]);\nexport var MainImg = styled.img.withConfig({\n  displayName: \"EditTool__MainImg\",\n  componentId: \"g78bad-1\"\n})([\"width:50%;margin:10px auto;display:block;cursor:pointer;\"]);\nexport var SecondaryImages = styled.img.withConfig({\n  displayName: \"EditTool__SecondaryImages\",\n  componentId: \"g78bad-2\"\n})([\"max-width:25%;margin-right:5px;cursor:pointer;:hover{box-shadow:0 14px 28px rgba(0,0,0,0.25),0 10px 10px rgba(0,0,0,0.22);}box-shadow:0 3px 6px rgba(0,0,0,0.16),0 3px 6px rgba(0,0,0,0.23);\"]);\nexport var PrefImage = styled.img.withConfig({\n  displayName: \"EditTool__PrefImage\",\n  componentId: \"g78bad-3\"\n})([\"width:49%;margin-right:5px;margin-bottom:5px;cursor:pointer;:hover{box-shadow:0 14px 28px rgba(0,0,0,0.25),0 10px 10px rgba(0,0,0,0.22);}box-shadow:0 3px 6px rgba(0,0,0,0.16),0 3px 6px rgba(0,0,0,0.23);\"]);\nexport var MainFeaturesText = styled.p.withConfig({\n  displayName: \"EditTool__MainFeaturesText\",\n  componentId: \"g78bad-4\"\n})([\"\"]);\nexport var InputGroup = styled.div.withConfig({\n  displayName: \"EditTool__InputGroup\",\n  componentId: \"g78bad-5\"\n})([\"display:flex;flex-direction:column;width:\", \";\"], function (props) {\n  return props.width ? props.width : \"100%\";\n});\nexport var ContainerInputFile = styled.div.withConfig({\n  displayName: \"EditTool__ContainerInputFile\",\n  componentId: \"g78bad-6\"\n})([\"img{width:100%;margin:10px auto;display:block;cursor:pointer;}display:flex;justify-content:center;\"]);","map":null,"metadata":{},"sourceType":"module"}