{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from \"react\";\n\nvar getDisplayName = function getDisplayName(Component) {\n  return Component.displayName || Component.name || \"Component\";\n};\n\nexport var withAuthSync = function withAuthSync(WrappedComponent) {\n  var _class, _temp;\n\n  return _temp = _class = /*#__PURE__*/function (_Component) {\n    _inherits(_class, _Component);\n\n    function _class() {\n      _classCallCheck(this, _class);\n\n      return _possibleConstructorReturn(this, _getPrototypeOf(_class).apply(this, arguments));\n    }\n\n    _createClass(_class, [{\n      key: \"render\",\n      value: function render() {\n        return __jsx(WrappedComponent, this.props);\n      }\n    }], [{\n      key: \"getInitialProps\",\n      value: function getInitialProps(ctx) {\n        var token, componentProps;\n        return _regeneratorRuntime.async(function getInitialProps$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                token = auth(ctx);\n                _context.t0 = WrappedComponent.getInitialProps;\n\n                if (!_context.t0) {\n                  _context.next = 6;\n                  break;\n                }\n\n                _context.next = 5;\n                return _regeneratorRuntime.awrap(WrappedComponent.getInitialProps(ctx));\n\n              case 5:\n                _context.t0 = _context.sent;\n\n              case 6:\n                componentProps = _context.t0;\n                return _context.abrupt(\"return\", _objectSpread({}, componentProps, {\n                  token: token\n                }));\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      }\n    }]);\n\n    return _class;\n  }(Component), _defineProperty(_class, \"displayName\", \"withAuthSync(\".concat(getDisplayName(WrappedComponent), \")\")), _temp;\n};\nimport Router from \"next/router\";\nimport nextCookie from \"next-cookies\";\nexport var auth = function auth(ctx) {\n  var _nextCookie = nextCookie(ctx),\n      user = _nextCookie.user;\n\n  if (ctx.req && !user) {\n    ctx.res.writeHead(302, {\n      Location: \"/login\"\n    });\n    ctx.res.end();\n    return;\n  }\n\n  if (!user) {\n    Router.push(\"/login\");\n  }\n\n  return user;\n};","map":{"version":3,"sources":["C:/Users/Gluz/Projects/web/multcostura/multcostura-web/src/utils/auth.js"],"names":["React","Component","getDisplayName","displayName","name","withAuthSync","WrappedComponent","props","ctx","token","auth","getInitialProps","componentProps","Router","nextCookie","user","req","res","writeHead","Location","end","push"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;AAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAAAD,SAAS;AAAA,SAC9BA,SAAS,CAACE,WAAV,IAAyBF,SAAS,CAACG,IAAnC,IAA2C,WADb;AAAA,CAAhC;;AAGA,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAC,gBAAgB;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,+BAc/B;AACP,eAAO,MAAC,gBAAD,EAAsB,KAAKC,KAA3B,CAAP;AACD;AAhBuC;AAAA;AAAA,sCAIXC,GAJW;AAAA;AAAA;AAAA;AAAA;AAAA;AAKhCC,gBAAAA,KALgC,GAKxBC,IAAI,CAACF,GAAD,CALoB;AAAA,8BAQpCF,gBAAgB,CAACK,eARmB;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,iDAS7BL,gBAAgB,CAACK,eAAjB,CAAiCH,GAAjC,CAT6B;;AAAA;AAAA;;AAAA;AAOhCI,gBAAAA,cAPgC;AAAA,mEAW1BA,cAX0B;AAWVH,kBAAAA,KAAK,EAALA;AAXU;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,IAC5BR,SAD4B,iEAEHC,cAAc,CAACI,gBAAD,CAFX;AAAA,CAArC;AAmBP,OAAOO,MAAP,MAAmB,aAAnB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AAEA,OAAO,IAAMJ,IAAI,GAAG,SAAPA,IAAO,CAAAF,GAAG,EAAI;AAAA,oBACRM,UAAU,CAACN,GAAD,CADF;AAAA,MACjBO,IADiB,eACjBA,IADiB;;AAGzB,MAAIP,GAAG,CAACQ,GAAJ,IAAW,CAACD,IAAhB,EAAsB;AACpBP,IAAAA,GAAG,CAACS,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAvB;AACAX,IAAAA,GAAG,CAACS,GAAJ,CAAQG,GAAR;AACA;AACD;;AAED,MAAI,CAACL,IAAL,EAAW;AACTF,IAAAA,MAAM,CAACQ,IAAP,CAAY,QAAZ;AACD;;AAED,SAAON,IAAP;AACD,CAdM","sourcesContent":["import React, { Component } from \"react\";\n\nconst getDisplayName = Component =>\n  Component.displayName || Component.name || \"Component\";\n\nexport const withAuthSync = WrappedComponent =>\n  class extends Component {\n    static displayName = `withAuthSync(${getDisplayName(WrappedComponent)})`;\n\n    static async getInitialProps(ctx) {\n      const token = auth(ctx);\n\n      const componentProps =\n        WrappedComponent.getInitialProps &&\n        (await WrappedComponent.getInitialProps(ctx));\n\n      return { ...componentProps, token };\n    }\n\n    render() {\n      return <WrappedComponent {...this.props} />;\n    }\n  };\n\nimport Router from \"next/router\";\nimport nextCookie from \"next-cookies\";\n\nexport const auth = ctx => {\n  const { user } = nextCookie(ctx);\n\n  if (ctx.req && !user) {\n    ctx.res.writeHead(302, { Location: \"/login\" });\n    ctx.res.end();\n    return;\n  }\n\n  if (!user) {\n    Router.push(\"/login\");\n  }\n\n  return user;\n};\n"]},"metadata":{},"sourceType":"module"}